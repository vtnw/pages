<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Track</title>    
</head>
<body>
    <select id="ddlType" style="border:none;outline:none;-moz-appearance:none;-webkit-appearance:none;font-weight:bold;">
        <option value="item_note">note</option>
        <option value="item_task">task</option>
    </select>
    <br />
    <input type="text" id="tbItem" style="border:none;width:97%;outline:none;" placeholder="Add" />
    <br /><br />
    <div id="dvItems"></div>
    <script>
        document.getElementById("ddlType").addEventListener("change", function () {            
            buildItems();
        });
        document.getElementById("tbItem").addEventListener("keyup", function (event) {
            event.preventDefault();
            if (event.keyCode == 13 && document.getElementById("tbItem").value.trim() != "") {
                var items = getCache();
                items.push(document.getElementById("tbItem").value);
                document.getElementById("tbItem").value = "";
                setCache(items);
                buildItems();
            }
        });
        function buildItems() {
            var items = getCache();
            var dvItems = document.getElementById("dvItems");
            dvItems.innerHTML = "";
            for (var i = 0; i < items.length; i++) {
                var dvItem = document.createElement('div');
                dvItem.innerHTML = items[i];
                dvItem.setAttribute("index", i);
                dvItem.appendChild(document.createElement('br'));
                dvItem.appendChild(document.createElement('br'));
                dvItem.addEventListener("click", function () {
                    var index = parseInt(this.getAttribute("index"));
                    var items = getCache();
                    items.splice(index, 1);
                    setCache(items);
                    buildItems();
                    document.getElementById("tbItem").value = this.innerText;
                });
                dvItems.insertBefore(dvItem, dvItems.firstChild);
            }
        }
        function getCache() {
            var cacheName = document.getElementById("ddlType").value;
            var items = JSON.parse(localStorage.getItem(cacheName));
            if (items == null) {
                items = [];
            }
            return items;
        }
        function setCache(items) {
            var cacheName = document.getElementById("ddlType").value;
            localStorage.setItem(cacheName, JSON.stringify(items));
        }
        buildItems();
    </script>
</body>
</html>
