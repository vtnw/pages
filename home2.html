<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="viewport" content="width =device-width, initial-scale=1.0">
    <title>Home</title>    
</head>
<body>    
    <div id="dvLinks"></div><br/>
    <input type="text" id="tbLink" placeholder="title | url" style="border:none;outline:none;" />
    <script>
      var key = decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]" + encodeURIComponent("u").replace(/[\.\+\*]/g, "\\$&") + "(?:\\=([^&]*))?)?.*$", "i"), "$1"));
      var cacheName = "home" + key;
      document.getElementById("tbLink").addEventListener("keyup", function (event) {
          event.preventDefault();
          var value = document.getElementById("tbLink").value.trim();
          if (event.keyCode == 13 && value != "") {
              var links = getCache();
              var linkData = value.split("|");
              links.push({"title": linkData[0], "url": linkData[1]});
              links.sort(function (a, b) { return a.title > b.title });
              setCache(links);
              buildLinks();
              document.getElementById("tbLink").value = "";
              document.getElementById("tbLink").blur();
          }
      });
      function buildLinks() {
          var links = getCache();
          var dvLinks = document.getElementById("dvLinks");
          dvLinks.innerHTML = "";
          for (var i = 0; i < links.length; i++) {
              var a = document.createElement('a');                
              a.setAttribute("href", links[i].url);
              a.innerHTML = links[i].title;
              dvLinks.appendChild(document.createElement('br'));
              dvLinks.appendChild(document.createElement('br'));
              dvLinks.appendChild(a);
          }
      }        
      function getCache() {
          var items = JSON.parse(localStorage.getItem(cacheName));
          if (items == null) {
              items = [];
          }          
          return items;
      }
      function setCache(items) {
          localStorage.setItem(cacheName, JSON.stringify(items));
      }
      buildLinks();
    </script>
</body>
</html>
